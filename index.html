<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CryptoDash Pro â€” Binance Edition</title>
  <style>
    body {margin:0;font-family:sans-serif;background:#0f172a;color:#e2e8f0}
    header {display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#1e293b}
    h1 {margin:0;font-size:1.2rem}
    .container {padding:1rem}
    table {width:100%;border-collapse:collapse}
    th,td {padding:0.6rem;text-align:left;border-bottom:1px solid #334155}
    tr:hover {background:#1e293b;cursor:pointer}
    .muted {color:#94a3b8;font-size:0.9rem}
    #detail {display:none;padding:1rem}
    #chart {height:480px}
    button {padding:0.4rem 0.8rem;border:0;border-radius:6px;background:#334155;color:white;cursor:pointer}
    button:hover {background:#475569}
  </style>
  <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
</head>
<body>
  <header>
    <h1>ðŸ“Š CryptoDash Pro</h1>
    <div>
      <button onclick="showList()">Home</button>
    </div>
  </header>

  <main class="container">
    <!-- Halaman List -->
    <section id="list">
      <h2>Market List (Binance)</h2>
      <table>
        <thead>
          <tr><th>Symbol</th><th>Last Price</th><th>24h Change</th><th>Volume</th></tr>
        </thead>
        <tbody id="marketBody"></tbody>
      </table>
    </section>

    <!-- Halaman Detail -->
    <section id="detail">
      <h2 id="coinTitle">Detail</h2>
      <div id="chart"></div>
      <p id="coinInfo" class="muted"></p>
    </section>
  </main>

<script>
const API = "https://api.binance.com/api/v3";

// Tampilkan daftar koin USDT utama
async function loadMarket(){
  const res = await fetch(`${API}/ticker/24hr`);
  const data = await res.json();
  const top = data.filter(d=>d.symbol.endsWith("USDT"))
                  .slice(0,20); // 20 coin teratas
  const tbody = document.getElementById("marketBody");
  tbody.innerHTML = "";
  top.forEach(c=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${c.symbol}</td>
                  <td>${parseFloat(c.lastPrice).toFixed(4)}</td>
                  <td style="color:${c.priceChangePercent>=0?'#4ade80':'#f87171'}">
                    ${parseFloat(c.priceChangePercent).toFixed(2)}%
                  </td>
                  <td>${Number(c.quoteVolume).toFixed(0)}</td>`;
    tr.onclick=()=>showDetail(c.symbol);
    tbody.appendChild(tr);
  });
}

// Tampilkan halaman detail
async function showDetail(symbol){
  document.getElementById("list").style.display="none";
  document.getElementById("detail").style.display="block";
  document.getElementById("coinTitle").textContent=symbol;

  // ambil candlestick (daily)
  const res = await fetch(`${API}/klines?symbol=${symbol}&interval=1d&limit=100`);
  const data = await res.json();

  // mapping ke format lightweight-charts
  const candles = data.map(c=>({
    time: Math.floor(c[0]/1000),
    open: parseFloat(c[1]),
    high: parseFloat(c[2]),
    low: parseFloat(c[3]),
    close: parseFloat(c[4])
  }));

  document.getElementById("chart").innerHTML=""; // reset
  const chart = LightweightCharts.createChart(document.getElementById("chart"),{
    layout:{background:{color:'#0f172a'},textColor:'#e2e8f0'},
    grid:{vertLines:{color:'#1e293b'},horzLines:{color:'#1e293b'}},
    timeScale:{borderColor:'#334155'},rightPriceScale:{borderColor:'#334155'}
  });
  const candleSeries=chart.addCandlestickSeries();
  candleSeries.setData(candles);

  // Info singkat
  const last = candles[candles.length-1];
  document.getElementById("coinInfo").textContent =
    `Open: ${last.open} | High: ${last.high} | Low: ${last.low} | Close: ${last.close}`;
}

// Balik ke list
function showList(){
  document.getElementById("detail").style.display="none";
  document.getElementById("list").style.display="block";
}

// load awal
loadMarket();
</script>
</body>
</html>
